<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.govsbu.sd.taxbankplatform.gxgsService.mapper.ClientMapper">
	<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/> 
	<select id="findDataByTime" parameterType="java.lang.String" resultType="hashmap" flushCache="true" useCache="true">
		${value} 
	</select>
	<!-- 获取传入数据库表名的主键key -->
	<select id="findPrimaryKey" parameterType="java.lang.String" resultType="hashmap"> 
		${value} 
	</select>
	<!-- 保存银行端插入语句同步数据到税局的记录-->
	<insert id="insertYhi" parameterType="map" >
		insert into tb_data_synchro_yhi (
			xh,
			pch,
			keyid,
			tablename,
			synstartime,
			synendtime,
			createtime,
			updatetime

			)   
		values (
			#{xh},
			#{pch},
			#{keyid},
			#{tablename},
			#{synstartime},
			#{synendtime},
			#{createtime},
			#{updatetime}
			)  
	</insert>
		<!-- 税局端接收到银行端的同步插入语句的数据将结果返回 Y是数据段接收到了银行端同步的数据 -->
	<update id="updateYhi" parameterType="map" flushCache="true">
		update tb_data_synchro_yhi set flag = #{flag},bz = #{bz},updatetime = now() where pch = #{pch}
	</update>
		<!-- 保存银行端更新语句同步数据到税局的记录-->
	<insert id="insertYhu" parameterType="map" >
		insert into tb_data_synchro_yhu (
			xh,
			pch,
			keyid,
			tablename,
			synstartime,
			synendtime,
			createtime,
			updatetime

			)   
		values (
			#{xh},
			#{pch},
			#{keyid},
			#{tablename},
			#{synstartime},
			#{synendtime},
			#{createtime},
			#{updatetime}
			)  
	</insert>
		<!-- 税局端接收到银行端的更新语句同步的数据将结果返回 Y是数据段接收到了银行端同步的数据 -->
	<update id="updateYhu" parameterType="map" flushCache="true">
		update tb_data_synchro_yhu set flag = #{flag},bz = #{bz},updatetime = now() where pch = #{pch}
	</update>
	<!-- 根据传入的表名获取该表在上一次查询的数据的最新一条的数据的主键id -->
	<select id="findPrimaryKeyByTableName" parameterType="java.lang.String" resultType="hashmap"> 
		${value} 
	</select>
	<!-- 插入语句根据传入的表名同步开始的时间和接收的时间获取该表在上一次查询的数据可能遗漏的数据 -->
	<select id="findDatai59BySynstarAndSynend" parameterType="java.lang.String" resultType="hashmap"> 
		${value} 
	</select>
	<!-- 更新语句根据传入的表名同步开始的时间和接收的时间获取该表在上一次查询的数据可能遗漏的数据 -->
	<select id="findDatau59BySynstarAndSynend" parameterType="java.lang.String" resultType="hashmap"> 
		${value} 
	</select>
	
	<!-- 测试同步数据 -->
	<!-- <insert id="insertNsryh" parameterType="map" >
		insert into tb_nsryh (
			nsryh_id,
			region_id,
			nsryhxx_id,
			nsryh_qdcode,
			nsryh_name,
			nsryh_password,
			nsryh_credentials_salt,
			enabled,
			creatorid,
			yxs,
			createtime,
			updatorid,
			updatetime

			)   
		values (
			#{id},
			"11111",
			"222222",
			"333333",
			"4444444",
			"555555",
			"666666",
			"N",
			"test",
			"Y",
			#{createtime},
			"test",
			#{updatetime}
			)  
	</insert> -->
</mapper>