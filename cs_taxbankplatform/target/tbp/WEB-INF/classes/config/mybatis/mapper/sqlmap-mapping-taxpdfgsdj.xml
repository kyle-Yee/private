<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dcits.govsbu.sd.taxbankplatform.taxpdf.mapper.TaxPdfGsdjMapper" >
<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/> 
  <resultMap id="BaseResultMap" type="com.dcits.govsbu.sd.taxbankplatform.taxpdf.model.TaxPdfGsdjEntity" >
		<association property="taxGsdjEntity" javaType="com.dcits.govsbu.sd.taxbankplatform.taxpdf.model.TaxGsdjEntity">
			<result property="qymc" column="nsryhxx_qymc"/>
			<result property="zczb" column="tthk_zczb" />
			<result property="zzjgkxdm" column="tthk_zzjgkx_dm"/>
			<result property="zcdz" column="tth_zcdz"/>
			<result property="djzclxdm" column="tth_djzclx_dm"/>
			<result property="nsrztdm" column="tth_nsrzt_dm"/>
			<result property="cyrs" column="tthk_cyrs"/>
			<result property="jyfw" column="tthk_jyfw"/>
			<result property="nsrsbh" column="tth_nsrsbh"/>
			<result property="djrq" column="tth_djrq"/>
			<result property="hymc" column="hy_mc"/>
		</association>
  </resultMap>
  
  <!-- 查询工商登记信息 -->
   <select id="findByDjxh" parameterType="map" resultMap="BaseResultMap" flushCache="true" useCache="true">
  	SELECT
	  	 tnx.nsryhxx_qymc, 
	  	 ttqk.tthk_zczb, 
	  	 ttqk.tthk_zzjgkx_dm, 
	  	 ttq.tth_zcdz, 
	  	 ttq.tth_djzclx_dm,
	  	 ttq.tth_nsrzt_dm,
	  	 ttq.tth_nsrsbh,
	  	 ttq.tth_djrq,
	  	 ttqk.tthk_cyrs,
	  	 ttqk.tthk_jyfw,
	  	 th.hy_mc ,
	  	 djzclx.djzclxmc,
	  	 nsrzt.nsrztmc
	FROM tb_nsryhxx tnx
	LEFT JOIN t_tax_qyjcxx ttq ON tnx.nsryhxx_nsrsbh = ttq.tth_nsrsbh
	LEFT JOIN t_tax_qyjcxx_kz ttqk ON ttq.djxh = ttqk.djxh
	AND ttq.sqxh = ttqk.sqxh
	LEFT JOIN tb_hydm th ON ttq.tth_hy_dm = th.hy_dm
	LEFT JOIN t_djzclx_dm  djzclx ON ttq.tth_djzclx_dm=djzclx.djclx_dm
	LEFT JOIN t_gy_nsrzt_dm nsrzt on ttq.tth_nsrzt_dm=nsrzt.nsrzt_dm
	where tnx.creatorid = #{userid} AND ttq.sqxh = #{sqxh} order by ttq.createtime desc
	</select>
</mapper>