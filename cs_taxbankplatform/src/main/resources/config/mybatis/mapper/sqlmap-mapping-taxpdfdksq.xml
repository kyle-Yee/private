<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dcits.govsbu.sd.taxbankplatform.taxpdf.mapper.TaxPdfDksqMapper" >
<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/> 
  <resultMap id="BaseResultMap" type="com.dcits.govsbu.sd.taxbankplatform.taxpdf.model.TaxPdfDksqEntity" >
    <id property="id" column="la_id"/>
		<result property="region_id" column="region_id"/>
		<result property="rw_name" column="rw_name"/>
		<result property="fp_id" column="fp_id" />
		<result property="rw_id" column="rw_id"/>
		<result property="nsrsbh" column="nsrsbh"/>
		<result property="la_serial_number" column="la_serial_number"/>
		<result property="la_amount" column="la_amount"/>
		<result property="la_repay_loan_deadline" column="la_repay_loan_deadline"/>
		<result property="la_apply_time" column="la_apply_time"/>
		<result property="la_first_time" column="la_first_time"/>
		<result property="la_end_time" column="la_end_time"/>
		<result property="la_status" column="la_status"/>
		<result property="la_remark" column="la_remark"/>
		<result column="creatorid" property="creatorid" />
	    <result column="createtime"  property="createtime" />
	    <result column="updatorid" property="updatorid" />
	    <result column="updatetime"  property="updatetime" />
	    <result column="nsryhxx_zcsjh"  property="zcsjh" />
	    <result column="tthk_cyrs"  property="cyrs" />
	    <collection property="loanFormsAttachList" ofType="com.dcits.govsbu.sd.taxbankplatform.loanformsattach.model.LoanFormsAttach">
	     <id column="lfa_id" property="id" />
	    <result column="pdi_name"  property="pdi_name" />
	    <result column="pdi_values"  property="pdi_values" />
	    </collection>
  </resultMap>
  
  <sql id="Base_Column_List" >
    la_id,region_id,fp_id,rw_id,nsrsbh,la_serial_number,la_amount,
	la_repay_loan_deadline,la_apply_time,la_first_time,la_end_time,
	la_status,la_remark,creatorid,createtime,updatorid,updatetime
  </sql>
  <!-- 根据选中的记录查询数据 -->
  <select id="findById"  parameterType="map" resultMap="BaseResultMap" >
    select 
    la.la_id,la.region_id,la.fp_id,la.rw_id,tw.rw_name,la.nsrsbh,la.la_serial_number,la.la_amount,
	la.la_repay_loan_deadline,la.la_apply_time,la.la_first_time,la.la_end_time,
	la.la_status,la.la_remark,la.creatorid,la.createtime,la.updatorid,la.updatetime,
	lfa.pdi_name,lfa.pdi_values,tn.nsryhxx_zcsjh,tq.tthk_cyrs
	FROM tb_loan_apply la
	LEFT JOIN tb_nsryhxx tn ON la.nsrsbh = tn.nsryhxx_nsrsbh
	LEFT JOIN t_tax_qyjcxx_kz tq ON tn.nsryhxx_djxh = tq.djxh
	LEFT JOIN tb_loan_forms lf ON la.la_id = lf.la_id
	LEFT JOIN tb_loan_forms_attach lfa ON lf.lf_id = lfa.lf_id
	LEFT JOIN tb_repayment_way tw ON la.rw_id = tw.rw_id
	WHERE la.la_id = #{id} AND tq.sqxh = #{sqxh}
  </select>
  
  <!-- 根据id获取还款方式 （单个）-->
  <select id="getHkfsName" parameterType="java.lang.String" resultType="java.lang.String">
  		SELECT rw_name FROM tb_repayment_way WHERE rw_id=#{id}
  </select>
</mapper>